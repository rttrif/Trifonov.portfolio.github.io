# Тестовое задание от СберМаркета 

### Project Objectives

**Основная задача аналитиков в нашей компании - растить бизнес.**

Иногда мы сами не знаем где прячутся эти точки кратного роста, поэтому порой приходится кранчить данные и искать зависимости/аномалии, генерировать гипотезы в процессе и потом предлагать проекты. 

Мы дадим доступ к базе со срезом транзакций. 

**Твое задание:** найти все интересные на твой взгляд инсайты и представь их в любом удобном виде (ноутбук желательно приложить). 

### PPDAC Cycle

#### Problem
**Описание проблемы:** У нашего бизнеса есть большая проблема с ненайденными товарами: Клиент заказывает товары, но они заканчиваются в магазине к моменту начала сборки. Пользователи, очевидно, очень недовольны таким опытом

#### Plan
**Этап 1.** Оценка проекта и определение проблемы 

**Этап 2.** Предварительная подготовка данных
1. Загрузить исходные данные из базы данных 
1. Описать доступный набор предикторов 
	- Смысл переменных 
	- Классификация переменных по виду
1. Оценить качество исходных данных 

**Этап 3.** Предварительный разведочный анализ
1. Описательные статистики исходных данных
1. Оценка распределения данных 
1. Оценка наличия выбросов в данных
1. Оценка корреляции между данными 
1. Оценка распределения переменных по времени 

**Этап 4.** 
1. Очистка данных
1. Трансформация данных
1. Обогащение данных  

**Этап 5.** Разведочный анализ (основной этап) 
1. Описательные статистики исходных данных
1. Оценка распределения данных 
1. Оценка наличия выбросов в данных
1. Оценка корреляции между данными 
1. Оценка распределения переменных по времени 
1. Выводы 


#### Data

База данных Postgresql со срезом транзакций

#### Analysis
- Выполнить этапы 2 и 5 плана для более точного анализа 
- Возможные варианты решения задачи: 
	- Система прогнозирования пополнения запасов в зависимости от потребительского спроса 
	- Информирование клиентов об остатках на складе 
- Предварительный вариант решения: 
	- Классифицировать случаи возникновения ненайденных товаров (Задача классификации)
	- Построить регрессионную модель  предсказывающую необходимость пополнения запасов  

#### Conclusions / Comments

- Составить пояснительную записку к проекту 

### Success criteria

- Знания ведущие к росту бизнеса

### _Describe data_

**orders**
- **id** -id заказа --> _Порядковая_
- **created_at** - timestamp создания заказа на сайте --> _Порядковая_
- **delivery_window_id** - id слота доставки  --> _Порядковая_
- **item_total** - Сумма всех товаров в корзине (средний чек) --> ___Количественная___
- **promo_total** - Сумма промо-кода на товары в корзине --> ___Количественная___
- **cost** - Изначальная стоимость доставки --> ___Количественная___
- **total_cost** - Финальная стоимость доставки (отличается, если был применен промо-код на доставку. Если промокода не было, то cost=total_cost) --> ___Количественная___
- **ship_address_id** - id адреса доставки (ключ к addresses.id) --> __Номинальная__
- **shipped_at** - timestamp доставки заказа) --> __Номинальная__
- **state** - состояние доставки (shipped, canceled и тд) --> __Номинальная__
- **store_id** - id магазина --> _Порядковая_
- **total_quantity** - Количество единиц товара --> ___Количественная___
- **total_weight** - Вес заказа , г. --> ___Количественная___
- **user_id** - id пользователя --> _Порядковая_

**delivery_windows**
- **id** - id слота доставки (ключ к orders.delivery_window_id) --> _Порядковая_
- **starts_at** - timestamp начала слота доставки --> _Порядковая_
- **ends_at** - timestamp конца слота доставки --> _Порядковая_
- **store_id** - ID магазина --> _Порядковая_


**stores**
- **id** - ID магазина --> __Номинальная__
- **city** - ID города --> __Номинальная__
- **retailer_id** - ID ритейлера --> __Номинальная__

**addresses**
- **id** - ID адреса (ключ к orders.ship_address_id) --> __Номинальная__
- **lat** - latitude --> _Порядковая_
- **lon** - longitude --> _Порядковая_

**replacements**
- **item_id** - id товара, который был заменен --> __Номинальная__
- **order_id** - id заказа, в котором была замена --> __Номинальная__
- **state** - статус (замена) --> __Номинальная__

**cancellations**
- **item_id** - id товара, который был отменен --> __Номинальная__
- **order_id** - id заказа, в котором была отмена --> __Номинальная__
- **state** - статус (отмена) --> __Номинальная__

### _Goals and objectives of the analysis_

![Анализ задачи](https://github.com/rttrif/Trifonov.portfolio.github.io/blob/master/2.%20Exploratory%20Data%20Analys/EDA/%5B0011%5D%20Project%203%20-%20SberMarket/%D0%A1%D0%B5%D0%B1%D0%B5%D1%80%D0%9C%D0%B0%D1%80%D0%BA%D0%B5%D1%82.png)

- Набор данных **hassle_free_orders** отражает параметры нормально работающего процесса. 
- Набор данных **problematic_orders** отражает параметры проблем в процессе
- **Задача: Исследовать проблемы в процессе**

## CONCLUSIONS

- Набор данных hassle_free_orders отражает параметры нормально работающего процесса.
- Набор данных problematic_orders отражает параметры проблем в процессе
- Задача: Исследовать проблемы в процессе

- В целом анализ гистограмм распределения показывает, что распределение данных в значительной степени отличается от нормального и имеют хвосты.
- В наборе hassle_free_orders все заказы имеют статус «shipped».
- 94.7% заказов приходится на европейский часовой пояс, город Москва
- Распределение данных в значительной степени отличается от нормального и имеют хвосты.
- Диаграмма рассеянья заказов (order_id) и товаров, которые были отменены / заменены (item_id) показывает, что в целом товары данной категории образуют группу и значительное количество выбросов. Т.е. если минимизировать нарушения в процессе основной группы – это может повысить качества процесса оставив только относительно редкие события образующие выбросы.
- 60.7 % проблемный заказов отменяются, 39.3% заменяются. Такое соотношение крайне негативно сказывается на бизнесе.

- Имеется значительное количество выбросов превышающих интерквантильный размах

- Анализ географических данных показывает, что имеется 7 областей в которых осуществляются продажи при этом анализ временных зон показывает, что продажи ведутся в 5 городах(Москва, Самара, Екатеринбург, Омск, Калининград). Каждый город имеет разный объем продаж, что выделено соответствующим цветом.
- Продажи в меньших областях продажи происходят в магазинах с одним и тем же store_id, что позволяет из отнести к Самаре, Екатеринбургу, Омску Калининграду. В крупной области продажи происходят в разных магазинах, что позволяет предположить, что это Москва.
- Анализ географических данных по retailer_id основная часть магазинов принадлежит одному ретейлеру.

- Корреляционный анализ показывает, что между различным id есть сильная линейная связь, так же есть сильная линейная зависимость между весом заказа и его стоимостью. В целом для будущего построения моделей машинного обучения это означает, что от id можно и нужно избавиться для уменьшения размерности данных.
- Анализ временного ряда item_id ко времени created_at показывает, что тренды в данном временном ряду отсутствуют т.е. он по большому счету стационарен.
- Сезонности за период 180 дней не наблюдается. Автокорреляции нет.
- Аналогичные выводы относятся к ряду item_id ко времени shipped_at.
- Анализ рядов item_id к starts_at и item_id к ends_at, что данные ряды не стационарны и имеют тренды, а так же сезонные колебания.
- С точки зрения решения поставленной задачи, наибольший интерес представляет анализ 30 дневного скользящего среднего по проблемным товарам и слотам начал и конца доставки. Т.к. зная подобные колебания и группы товаров относящихся к проблемному процессу мы можем сделать модель по предсказанию уровня запасов на складе в каждый конкретный месяц с детализации по неделям.
